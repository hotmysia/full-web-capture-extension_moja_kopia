<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test PDF Download</title>
    <script src="jspdf.min.js"></script>
</head>
<body>
    <h1>Test PDF Download</h1>
    <button id="test-pdf">Test PDF Creation</button>
    <button id="test-image-to-pdf">Test Image to PDF</button>
    
    <div style="margin-top: 20px;">
        <img id="test-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==" width="100" height="100" style="background: red;">
    </div>

    <script>
        document.getElementById('test-pdf').addEventListener('click', function() {
            console.log('Testing basic PDF creation...');
            
            if (!window.jspdf) {
                alert('jsPDF not loaded');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();
                pdf.text('Hello PDF!', 10, 10);
                
                const blob = pdf.output('blob');
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'test.pdf';
                link.click();
                
                console.log('PDF created successfully');
                alert('PDF test successful!');
            } catch (error) {
                console.error('PDF test failed:', error);
                alert('PDF test failed: ' + error.message);
            }
        });
        
        document.getElementById('test-image-to-pdf').addEventListener('click', function() {
            console.log('Testing image to PDF...');
            
            if (!window.jspdf) {
                alert('jsPDF not loaded');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();
                
                // Tạo một canvas với ảnh đơn giản
                const canvas = document.createElement('canvas');
                canvas.width = 200;
                canvas.height = 200;
                const ctx = canvas.getContext('2d');
                
                // Vẽ một hình vuông đỏ
                ctx.fillStyle = 'red';
                ctx.fillRect(0, 0, 200, 200);
                
                // Thêm text
                ctx.fillStyle = 'white';
                ctx.font = '20px Arial';
                ctx.fillText('Test Image', 50, 100);
                
                const imageData = canvas.toDataURL('image/png');
                
                // Thêm vào PDF
                pdf.addImage(imageData, 'PNG', 10, 10, 50, 50);
                
                const blob = pdf.output('blob');
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = 'test-image.pdf';
                link.click();
                
                console.log('Image to PDF test successful');
                alert('Image to PDF test successful!');
            } catch (error) {
                console.error('Image to PDF test failed:', error);
                alert('Image to PDF test failed: ' + error.message);
            }
        });
    </script>
</body>
</html> 